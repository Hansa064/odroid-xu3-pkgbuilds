# ODROID Mali GL Driver
# Maintainer: gripped - forum.odroid.com

buildarch=4

pkgname=odroid-libgl-mali-T628-x11
pkgver=r4p0.02rel0
_pkgver=r4p0-02rel0
pkgrel=1
arch=('armv7h')
pkgdesc="ODROID Mali GL Driver"
url="http://malideveloper.arm.com/"
license=('Proprietary')
provides=('libegl' 'libgles' 'libMali' 'odroid-libgl')
conflicts=('odroid-libgl')
source=("http://malideveloper.arm.com/downloads/drivers/binary/${_pkgver}/mali-t62x_${_pkgver}_linux_1+x11.tar.gz")
md5sums=('27c00dd067d8d8a185a17c657aab16f0')


package() {
    install -d -m 0755 ${pkgdir}/opt/${pkgname}/lib

    cd ${srcdir}/x11
    install -m 0755 libEGL.so ${pkgdir}/opt/${pkgname}/lib
    install -m 0755 libGLESv1_CM.so ${pkgdir}/opt/${pkgname}/lib
    install -m 0755 libGLESv2.so ${pkgdir}/opt/${pkgname}/lib
    install -m 0755 libOpenCL.so ${pkgdir}/opt/${pkgname}/lib
    install -m 0755 libmali.so ${pkgdir}/opt/${pkgname}/lib
    

    cd ${pkgdir}/opt/${pkgname}/lib
    ln -s libEGL.so libEGL.so.1
    ln -s libEGL.so.1 libEGL.so.1.4 
    ln -s libGLESv1_CM.so libGLESv1_CM.so.1
    ln -s libGLESv1_CM.so libGLESv1_CM.so.1.1
    ln -s libGLESv2.so libGLESv2.so.2
    ln -s libGLESv2.so libGLESv2.so.2.0
    ln -s libOpenCL.so libOpenCL.so.1
    ln -s libOpenCL.so libOpenCL.so.1.0

    install -d -m 0755 ${pkgdir}/etc/ld.so.conf.d
    echo "/opt/${pkgname}/lib" > ${pkgdir}/etc/ld.so.conf.d/${pkgname}.conf
}
